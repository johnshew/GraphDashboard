<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Tesla Console</title>

    <script>
        window.onerror = function (errorMsg, url, lineNumber) {
            alert((lineNumber ? lineNumber : '') + '\r\n' + errorMsg + '\r\n' + (url ? url + ' ' : '')); 
        }
        // Show page load alerts on Tesla browser
    </script>

    <!-- Polyfile ES5 on Telsa - not sure if both are needed -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.5/es5-shim.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">

    <style>
        .tight {
            margin-bottom: 0px;
            margin-top: 0px;
            margin-left: 0px;
            margin-right: 0px;
            padding: 0px;
        }
    </style>


</head>

<body>
    <div id="top-nav" class="navbar navbar-inverse navbar-static-top tight">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#NavBarActions" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Dashboard</a>
            </div>
            <div class="navbar-collapse collapse" id="NavBarActions">
                <ul class="nav navbar-nav">
                    <li class="active"><a id="ShowMail" href="#">Mail</a></li>
                    <li><a id="ShowCalendar" href="#">Calendar</a></li>
                    <li style="display: none"><a id="ShowContacts" href="#">Contacts</a></li>
                    <li style="display: none"><a id="ShowNotes" href="#">Notes</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown">
                        <a class="dropdown-toggle" role="button" data-toggle="dropdown" href="#">
                            <i class="glyphicon glyphicon-user">&nbsp;<span id="UsernameText"></span></i>&nbsp;<span class="caret"></span>
                        </a>
                        <ul id="account-menu" class="dropdown-menu" role="menu">
                            <li><a id="DoLogout" href="#">Logout</a></li>
                            <li><a id="ShowAbout" href="#">About...</a></li>
                            <li><a id="ShowSettings" href="#Settings" data-toggle="modal">Settings...</a></li>
                        </ul>
                    </li>
                    <li><a id="DoLogin" href="#">Login</a></li>
                </ul>
            </div>
        </div>
        <!-- /container -->
    </div>


    <!-- Modal HTML -->


    <div class="container-fluid tight">

        <div id="App" class="row tight">
        </div>

        <!-- Div for mini console on Tesla browser -->
        <div class="row tight">
            <div id="DebugConsole" class="row tight" style="display: none">
                <div id="DebugLog" style="margin: 10px; padding: 10px; background: SkyBlue"></div>
                <div style="margin: 0px; padding: 10px">
                    <input id="DebugCmd" type="text" placeholder="> " style="width: 100%" />
                </div>
            </div>
        </div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="./kurve.js"></script>


    <script>
        var forceInPlaceLogin = false;
        var forceDebugConsole = false;

        (function () {
            var params = document.location.search.replace(/.*?\?/, "").split("&").map(function (kv) { return kv.split('='); }).reduce(function (prev, kva) { prev[kva[0]] = (!kva[1]) ? true : kva[1]; return prev }, {});
            if (forceDebugConsole || params["console"]) {
                var logger = document.getElementById('DebugLog');
                document.getElementById('DebugConsole').style.display = "";
                log = console.log;
                console.log = function () {
                    message = arguments && arguments[0];
                    if (message) {
                        try {
                            message = typeof message == "string" ? message : JSON.stringify(message);
                        }
                        catch (err) {
                            message = "[Could not stringify object]";
                        };
                    }
                    if (message) { logger.innerHTML += '<p>' + message + '</p>'; }
                    log.apply(console, arguments);
                };
                var cmd = document.getElementById('DebugCmd');
                cmd.onchange = function () {
                    var result = ""
                    try { result = eval(cmd.value); } catch (err) { result = "Unable to evaluate " + cmd.value + " with error " + err.toString(); }
                    console.log(result);
                    try { cmd.scrollIntoView(); } catch (err) { }
                }
            }
        })();

        console.log('Starting app');
    
        // Keeping jquery out of main react app.  Ultimately may move away from a bootstrap to a React navigation bar in which case this will go away.
        $(function () {
            $('.navbar-nav li').click(function () {
                $(this).addClass('active').siblings().removeClass('active');
            });
        });
    </script>

    <script src="./bundle.js"></script>
</body>

</html>